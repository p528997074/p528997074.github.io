<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>DHCP配置 | 学无止境</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="配置DHCP服务器了解DHCP协议工作原理​    DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）提供了动态配置IP地址的功能。在DHCP网络中，客户端不再需要自行输入网络参数，而是由DHCP服务器向客户端自动分配。 （1）DHCP客户端在网络中搜索服务器 （2）DHCP服务器向客户端响应服务 （3）DHCP客户端向目标服务器发出服务请求 （4">
<meta property="og:type" content="article">
<meta property="og:title" content="DHCP配置">
<meta property="og:url" content="http://yoursite.com/2020/02/03/DHCP%E9%85%8D%E7%BD%AE/index.html">
<meta property="og:site_name" content="学无止境">
<meta property="og:description" content="配置DHCP服务器了解DHCP协议工作原理​    DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）提供了动态配置IP地址的功能。在DHCP网络中，客户端不再需要自行输入网络参数，而是由DHCP服务器向客户端自动分配。 （1）DHCP客户端在网络中搜索服务器 （2）DHCP服务器向客户端响应服务 （3）DHCP客户端向目标服务器发出服务请求 （4">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="c:%5CUsers%5Cpzx%5CDesktop%5C%E5%9B%BE%E7%89%871.png">
<meta property="article:published_time" content="2020-02-03T08:29:01.315Z">
<meta property="article:modified_time" content="2020-02-03T08:48:06.568Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="c:%5CUsers%5Cpzx%5CDesktop%5C%E5%9B%BE%E7%89%871.png">
  
    <link rel="alternate" href="/atom.xml" title="学无止境" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-DHCP配置" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      DHCP配置
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2020/02/03/DHCP%E9%85%8D%E7%BD%AE/" class="article-date">
  <time datetime="2020-02-03T08:29:01.315Z" itemprop="datePublished">2020-02-03</time>
</a>
    
    
  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h1 id="配置DHCP服务器"><a href="#配置DHCP服务器" class="headerlink" title="配置DHCP服务器"></a>配置DHCP服务器</h1><h2 id="了解DHCP协议工作原理"><a href="#了解DHCP协议工作原理" class="headerlink" title="了解DHCP协议工作原理"></a>了解DHCP协议工作原理</h2><p>​    DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）提供了动态配置IP地址的功能。在DHCP网络中，客户端不再需要自行输入网络参数，而是由DHCP服务器向客户端自动分配。</p>
<p>（1）DHCP客户端在网络中搜索服务器</p>
<p>（2）DHCP服务器向客户端响应服务</p>
<p>（3）DHCP客户端向目标服务器发出服务请求</p>
<p>（4）DHCP服务器向客户端提供服务</p>
<a id="more"></a>

<h3 id="1、IP地址租用的过程"><a href="#1、IP地址租用的过程" class="headerlink" title="1、IP地址租用的过程"></a>1、IP地址租用的过程</h3><p>​    DHCP客户端首次启动时，会自动执行初始化过程以便从DHCP服务器获得租约，获取租约的过程大致分为四个不同的阶段</p>
<p>（1）IP租用请求</p>
<p>客户端发送DHCP  Discover</p>
<p>（2）IP租用提供</p>
<p>服务器向客户端响应DHCP服务</p>
<p>（3）IP租用选择</p>
<p>客户机选择IP地址</p>
<p>（4）IP租用确认</p>
<p>服务器确认</p>
<h3 id="2、获取IP地址后的处理过程"><a href="#2、获取IP地址后的处理过程" class="headerlink" title="2、获取IP地址后的处理过程"></a>2、获取IP地址后的处理过程</h3><p>（1）客户端重新登录时的IP处理<br>    DHCP客户端每次重新登录网络时，不需要再发送DHCP Discover信息，而是直接发送包含前一次所分配的IP地址的DHCP Request请求信息。<br>（2）IP地址的续约<br>    DHCP的租约期限一般默认是8天，DHCP客户端必须在租约过期前对它进行续约。</p>
<h2 id="DHCP配置："><a href="#DHCP配置：" class="headerlink" title="DHCP配置："></a>DHCP配置：</h2><h3 id="1、规划IP地址段"><a href="#1、规划IP地址段" class="headerlink" title="1、规划IP地址段"></a>1、规划IP地址段</h3><p>确定DHCP服务器应分发给客户端的IP地址范围。<br>192.168.10.0/24<br>192.168.10.100-192.168.10.200<br>为客户端确定正确的子网掩码<br>255.255.255.0<br>总经理专用地址：192.168.10.8（保留地址）<br>确定DHCP服务器不应向客户端分发的所有IP地址。<br>决定IP地址的租约期限<br>网关地址：192.168.10.254<br>DNS服务器地址：192.168.10.1</p>
<p>网卡配置文件存放位置：/etc/sysconfig/network-scripts</p>
<p>修改网卡配置文件：ifcfg-ens33</p>
<p>禁用网卡：ifdown  ens33</p>
<h3 id="2、安装DHCP服务器"><a href="#2、安装DHCP服务器" class="headerlink" title="2、安装DHCP服务器"></a>2、安装DHCP服务器</h3><p>yum install dhcp</p>
<h3 id="3、配置DHCP的服务器"><a href="#3、配置DHCP的服务器" class="headerlink" title="3、配置DHCP的服务器"></a>3、配置DHCP的服务器</h3><p>DHCP服务的配置文件：/etc/dhcp/dhcpd.conf</p>
<p>如果要配置DHCP需要查看样例文件参考，进行配置</p>
<p>/usr/share/doc/dhcp*/dhcpd.conf.example</p>
<p>做的时候先备份</p>
<p>主配置文件：/etc/dhcp/dhcpd.conf</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">option domain-name-servers 192.168.10.1;		&#x2F;&#x2F; 设置DNS服务器选项，可放在全局部份。</span><br><span class="line">subnet 192.168.10.0 netmask  255.255.255.0 &#123;	&#x2F;&#x2F;用于定义作用域</span><br><span class="line">range 192.168.10.100  192.168.10.200;			&#x2F;&#x2F;指定当前作用域中可供分配的IP地址范围</span><br><span class="line">option routers 192.168.10.254;					&#x2F;&#x2F;指定当前作用域的网关</span><br><span class="line">default-lease-time 86400;						&#x2F;&#x2F;默认租约时间，单位为秒</span><br><span class="line">max-lease-time  172800;							&#x2F;&#x2F;最大租约时间，一般设置为默认租约时间的2倍</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>dhcpd.conf配置文件的格式如下：<br>全局参数<br>声明 {<br>    配置选项/局部参数<br>    配置选项/局部参数<br>    ……<br>}</p>
<h4 id="保留特定的IP地址"><a href="#保留特定的IP地址" class="headerlink" title="保留特定的IP地址"></a>保留特定的IP地址</h4><p>（1）保留IP地址的作用<br>     DHCP服务器可以保留特定的IP地址给指定的客户端使用，也就是说，当这个客户端每次向DHCP服务器索取IP地址或更新租约时，DHCP服务器都会给该客户端分配相同的IP地址。</p>
<p>（2）保留IP地址的配置</p>
<p>Host teacher{<br>     Hardware ethernet 00:0C:29:21:98:D6;<br>     Fixed-address 192.168.10.100;<br>}</p>
<p>“host teacher”，指定为其保留IP地址的客户端名称，名称可以随便设置，如这里为“teacher”。<br>“hardware ethernet”，指定客户端计算机的MAC地址。<br>“fixed-address”，指定对应的保留IP地址。</p>
<h4 id="配置超级作用域"><a href="#配置超级作用域" class="headerlink" title="配置超级作用域"></a>配置超级作用域</h4><p>什么是超级作用域呢？将多个作用域组合在一起形成超级作用域</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">ddns-update-style none;</span><br><span class="line">shared-network test &#123;</span><br><span class="line">subnet 192.168.10.0 netmask 255.255.255.0 &#123;</span><br><span class="line">  range 192.168.10.100 192.168.10.200;</span><br><span class="line">  option domain-name-servers 192.168.10.1;</span><br><span class="line">  option domain-name &quot;internal.example.org&quot;;</span><br><span class="line">  option routers 192.168.10.1;</span><br><span class="line">  option broadcast-address 192.168.10.255;</span><br><span class="line">  default-lease-time 600;</span><br><span class="line">  max-lease-time 7200;</span><br><span class="line">&#125;</span><br><span class="line">subnet 192.168.0.0 netmask 255.255.255.0 &#123;</span><br><span class="line">  range 192.168.0.100 192.168.0.200;</span><br><span class="line">  option domain-name-servers 192.168.0.1;</span><br><span class="line">  option domain-name &quot;internal.example.org&quot;;</span><br><span class="line">  option routers 192.168.0.1;</span><br><span class="line">  option broadcast-address 192.168.0.255;</span><br><span class="line">  default-lease-time 600;</span><br><span class="line">  max-lease-time 7200;</span><br><span class="line">&#125;</span><br><span class="line">host web &#123;</span><br><span class="line">  hardware ethernet 00:0C:29:9D:EA:33;</span><br><span class="line">  filename &quot;vmunix.passacaglia&quot;;</span><br><span class="line">  server-name &quot;toccata.fugue.com&quot;;</span><br><span class="line">  Fixed-address 192.168.0.110;</span><br><span class="line">&#125;</span><br><span class="line">host DNS &#123;</span><br><span class="line">  hardware ethernet 00:0C:29:9D:EA:33;</span><br><span class="line">  filename &quot;vmunix.passacaglia&quot;;</span><br><span class="line">  server-name &quot;toccata.fugue.com&quot;;</span><br><span class="line">  Fixed-address 192.168.0.110;</span><br><span class="line">&#125;</span><br><span class="line">｝</span><br></pre></td></tr></table></figure></div>

<h4 id="配置DHCP中继代理服务器"><a href="#配置DHCP中继代理服务器" class="headerlink" title="配置DHCP中继代理服务器"></a>配置DHCP中继代理服务器</h4><p><img src="C:%5CUsers%5Cpzx%5CDesktop%5C%E5%9B%BE%E7%89%871.png" alt=""></p>
<p>（1）中继代理服务器网卡地址配置<br>       eth0:  192.168.10.2<br>       eth1:  192.168.0.1<br>（2）在dhcp服务器上配置静态路由<br>ip route add 192.168.0.0/24 via 192.168.10.2<br>（3）在中继服务器上开启转发功能：vim /etc/sysctl.conf<br>      修    改：net.ipv4.ip_forward=1<br>      启用转发：sysctl -p<br>（3）在中继服务器上安装dhcp服务<br>（4）配置主配置文件<br>Subnet 192.168.10.0 netmask 255.255.255.0{<br>   Range 192.168.10.20 192.168.10.254;<br>   Option routers 192.168.10.2;<br>   Default-lease-time 86400;<br>   Max-lease-time 172800;<br>}<br>Subnet 192.168.20.0 netmask 255.255.255.0{<br>   Range 192.168.0.20 192.168.20.254;<br>   Option routers 192.16820.1;<br>   Default-lease-time 86400;<br>   Max-lease-time 172800;<br>}</p>
<p>（5）配置中继代理： vim /etc/sysconfig/dhcrelay<br>修改：INTERFACES=“eth0 eth1”<br>     DHCPSERVERS=“192.168.10.1”<br>重启服务：service dhcrelay start</p>
<h3 id="4-启动DHCP服务"><a href="#4-启动DHCP服务" class="headerlink" title="4.启动DHCP服务"></a>4.启动DHCP服务</h3><p>systemctl  start  dhcpd.service</p>
<p>检查配置语法格式是否有误</p>
<p>dhcpd -t</p>
<h3 id="4、客户端配置"><a href="#4、客户端配置" class="headerlink" title="4、客户端配置"></a>4、客户端配置</h3><p>方式一：通过命令提示符</p>
<p>ipconfig  /release        //释放已经获得的IP地址</p>
<p>ipconfig  /renew        //重新申请IP地址</p>
<p>查看所有ip信息</p>
<p>ipconfig  /all</p>

      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            服务与进程,文件共享
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2020/02/03/%E7%A3%81%E7%9B%98%E7%9A%84%E5%88%86%E5%8C%BA%E4%B8%8E%E6%8C%82%E8%BD%BD/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">磁盘的分区与挂载</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: '',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        和天意乎
      
    </h3>
    <p class="avatar-slogan">
      视之不见名曰夷，听之不闻名曰希，搏之不得名曰微。此三者不可致诘，故混而为一。
    </p>
  </div>
</div>


  
    

  
    

  
    
  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/03/nginx%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">nginx安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/apache%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">apache安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%8F%8A%E6%8E%A7%E5%88%B6/">远程访问及控制</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/">服务与进程,文件共享</a>
          </li>
        
          <li>
            <a href="/2020/02/03/DHCP%E9%85%8D%E7%BD%AE/">DHCP配置</a>
          </li>
        
      </ul>
    </div>
  </div>

  
      <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 John Doe &nbsp;&nbsp;
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank" rel="noopener">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之   阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>