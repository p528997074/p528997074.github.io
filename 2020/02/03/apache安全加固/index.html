<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>apache安全加固 | 学无止境</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="apache安全加固禁止目录浏览123Options FollowSymLinksAllowOverride None   将Options Indexes FollowSymLinks 中的Indexes 去掉，就可以禁止 Apache显示该目录结构。  Indexes的作用就是当该目录下没有 index.html 文件时，自动显示目录结构。   禁止 Apache 访问 Web 目录之外的任何">
<meta property="og:type" content="article">
<meta property="og:title" content="apache安全加固">
<meta property="og:url" content="http://yoursite.com/2020/02/03/apache%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/index.html">
<meta property="og:site_name" content="学无止境">
<meta property="og:description" content="apache安全加固禁止目录浏览123Options FollowSymLinksAllowOverride None   将Options Indexes FollowSymLinks 中的Indexes 去掉，就可以禁止 Apache显示该目录结构。  Indexes的作用就是当该目录下没有 index.html 文件时，自动显示目录结构。   禁止 Apache 访问 Web 目录之外的任何">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-03T08:29:08.231Z">
<meta property="article:modified_time" content="2019-12-30T08:12:36.965Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="学无止境" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-apache安全加固" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      apache安全加固
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2020/02/03/apache%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/" class="article-date">
  <time datetime="2020-02-03T08:29:08.231Z" itemprop="datePublished">2020-02-03</time>
</a>
    
    
  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h1 id="apache安全加固"><a href="#apache安全加固" class="headerlink" title="apache安全加固"></a>apache安全加固</h1><h2 id="禁止目录浏览"><a href="#禁止目录浏览" class="headerlink" title="禁止目录浏览"></a>禁止目录浏览</h2><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Options FollowSymLinks</span><br><span class="line"></span><br><span class="line">AllowOverride None</span><br></pre></td></tr></table></figure></div>

<p> 将Options Indexes FollowSymLinks 中的Indexes 去掉，就可以禁止 Apache显示该目录结构。  <code>Indexes</code>的作用就是当该目录下没有 index.html 文件时，自动显示目录结构。 </p>
<p> 禁止 Apache 访问 Web 目录之外的任何文件。 </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Order Deny,Allow</span><br><span class="line"></span><br><span class="line">Deny from all</span><br></pre></td></tr></table></figure></div>

<p> 设置可访问的目录。 </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Order allow,deny</span><br><span class="line"></span><br><span class="line">Allow from &#x2F;web</span><br></pre></td></tr></table></figure></div>



<p>设置 Apache 的默认页面：</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DirectoryIndex index.html</span><br></pre></td></tr></table></figure></div>

<h2 id="日志配置"><a href="#日志配置" class="headerlink" title="日志配置"></a>日志配置</h2><p>Window下：</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LogFormat &quot;%h %l %u %t \&quot;%r\&quot; %&gt;s %b \&quot;%i\&quot; \&quot;%i\&quot;&quot; combined</span><br><span class="line"></span><br><span class="line">CustomLog &quot;|bin&#x2F;rotatelogs.exe logs&#x2F;localhost_access_log.%Y-%m-%d.log 86400 480&quot; combined</span><br></pre></td></tr></table></figure></div>

<p>增加红色字体这一行，即可开启apache日志并且按照日期划分创建。</p>
<h2 id="错误页面处理"><a href="#错误页面处理" class="headerlink" title="错误页面处理"></a>错误页面处理</h2><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">ErrorDocument 400 &#x2F;custom400.html</span><br><span class="line"></span><br><span class="line">ErrorDocument 401 &#x2F;custom401.html</span><br><span class="line"></span><br><span class="line">ErrorDocument 403 &#x2F;custom403.html</span><br><span class="line"></span><br><span class="line">ErrorDocument 404 &#x2F;custom404.html</span><br><span class="line"></span><br><span class="line">ErrorDocument 405 &#x2F;custom405.html</span><br><span class="line"></span><br><span class="line">ErrorDocument 500 &#x2F;custom500.html</span><br></pre></td></tr></table></figure></div>

<p>其中Customxxx.html 为要设置的错误页面。 </p>
<h3 id="隐藏Apache版本号-及其它敏感信息"><a href="#隐藏Apache版本号-及其它敏感信息" class="headerlink" title="隐藏Apache版本号 及其它敏感信息"></a><strong>隐藏Apache版本号</strong> 及其它敏感信息</h3><div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ServerSignature Off</span><br><span class="line"></span><br><span class="line">ServerTokens Prod</span><br></pre></td></tr></table></figure></div>

<h3 id="关闭-TRACE功能"><a href="#关闭-TRACE功能" class="headerlink" title="关闭 TRACE功能"></a>关闭 TRACE功能</h3><p> 关闭 TRACE 功能，防止 TRACE 方法被访问者恶意利用。</p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TraceEnable Off</span><br></pre></td></tr></table></figure></div>

<p> <strong>限制IP访问</strong> </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Options FollowSymLinks</span><br><span class="line"></span><br><span class="line">AllowOverride None</span><br><span class="line"></span><br><span class="line">Order Deny,Allow</span><br><span class="line"></span><br><span class="line">Deny from all</span><br><span class="line"></span><br><span class="line">Allow from 192.168.204.0&#x2F;24</span><br></pre></td></tr></table></figure></div>

<p>只允许从192.168.204.0/24 IP段内的用户访问，一般在限制后台访问时用到。</p>
<h2 id="风险操作项"><a href="#风险操作项" class="headerlink" title="风险操作项"></a>风险操作项</h2><p> <strong>Apache 降权</strong> </p>
<p>备份httpd.conf文件</p>
<p>修改：</p>
<p>User nobody</p>
<p>Group# -1</p>
<p>重启 APACHE</p>
<p>/apachectl restart</p>
<p>Windows中操作步骤为：</p>
<p>新建系统用户组www，新建系统用户apache并设置密码。</p>
<p>运行services.msc打开服务管理界面，双击apache2.2服务打开属性页，点击“登录”选项卡，选择“此账户”，填写账号和密码，确定。</p>
<p> <strong>防CC攻击</strong> </p>
<p>Timeout 10</p>
<p>KeepAlive On</p>
<p>KeepAliveTimeout 15</p>
<p>AcceptFilter http data</p>
<p>AcceptFilter https data</p>
<p> <strong>限制请求消息长度</strong> </p>
<p> LimitRequestBody 102400 </p>
<p> 上传文件的大小也会受到此参数限制。 </p>
<h3 id="绑定监听地址"><a href="#绑定监听地址" class="headerlink" title="绑定监听地址"></a>绑定监听地址</h3><p> 服务器有多个 IP 地址时，只监听提供服务的 IP 地址。 </p>
<p> 查看是否绑定 IP 地址 </p>
<p> cat /etc/httpd/conf/httpd.conf|grep Listen </p>
<p> Listen x.x.x.x:80 </p>
<p> 禁用 PUT、DELETE 等危险的 HTTP 方法 </p>
<p> 只允许 get、post 方法。 </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;Location &#x2F;&gt;  </span><br><span class="line"></span><br><span class="line">&lt;LimitExcept GET POST CONNECT OPTIONS&gt; </span><br><span class="line"></span><br><span class="line">  Order Allow,Deny </span><br><span class="line"></span><br><span class="line">  Deny from all </span><br><span class="line"></span><br><span class="line">&lt;&#x2F;LimitExcept&gt; </span><br><span class="line"></span><br><span class="line">&lt;&#x2F;Location&gt;</span><br></pre></td></tr></table></figure></div>


      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/2020/02/03/nginx%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            nginx安全加固
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2020/02/03/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%8F%8A%E6%8E%A7%E5%88%B6/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">远程访问及控制</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: '',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        和天意乎
      
    </h3>
    <p class="avatar-slogan">
      视之不见名曰夷，听之不闻名曰希，搏之不得名曰微。此三者不可致诘，故混而为一。
    </p>
  </div>
</div>


  
    

  
    

  
    
  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/03/nginx%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">nginx安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/apache%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">apache安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%8F%8A%E6%8E%A7%E5%88%B6/">远程访问及控制</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/">服务与进程,文件共享</a>
          </li>
        
          <li>
            <a href="/2020/02/03/DHCP%E9%85%8D%E7%BD%AE%EF%BC%9A/">DHCP配置：</a>
          </li>
        
      </ul>
    </div>
  </div>

  
      <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 John Doe &nbsp;&nbsp;
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank" rel="noopener">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之   阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>