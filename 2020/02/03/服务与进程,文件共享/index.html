<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>服务与进程,文件共享 | 学无止境</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  
  
  <meta name="description" content="服务与进程linux系统的运行级别运行级别0：关机模式：poweroff.target 运行级别1：单用户模式，仅用于root用户对系统进行维护时。rescue.target 运行级别2：多用户模式（没有NFS）。multi-user.target 运行级别3：完全多用户模式，即多用户文本界面模式，是标准的运行级别。multi-user.target 运行级别4：特定运行级别，基本不用的用户模式。">
<meta property="og:type" content="article">
<meta property="og:title" content="服务与进程,文件共享">
<meta property="og:url" content="http://yoursite.com/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/index.html">
<meta property="og:site_name" content="学无止境">
<meta property="og:description" content="服务与进程linux系统的运行级别运行级别0：关机模式：poweroff.target 运行级别1：单用户模式，仅用于root用户对系统进行维护时。rescue.target 运行级别2：多用户模式（没有NFS）。multi-user.target 运行级别3：完全多用户模式，即多用户文本界面模式，是标准的运行级别。multi-user.target 运行级别4：特定运行级别，基本不用的用户模式。">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2020-02-03T08:29:01.317Z">
<meta property="article:modified_time" content="2020-02-03T08:47:23.582Z">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="学无止境" type="application/atom+xml">
  
  
    <link rel="icon" href="/images/default-avatar.jpg">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  
<link rel="stylesheet" href="/css/highlight.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="fullpage" class="mobile-nav-right">
    
      <div id="wrapper" title="图片来自网络">
    
    
      <header id="header">
  <div id="nav-toggle" class="nav-toggle"></div>
  <div class="head-box global-width">
    <nav class="nav-box nav-right">
      
        <a class="nav-item" href="/" title
        
        >首页</a>
      
        <a class="nav-item" href="/archives" title
        
        >归档</a>
      
    </nav>
  </div>
</header>
      <div id="middlecontent" title class="global-width sidebar-right">
        <section id="main"><article id="post-服务与进程,文件共享" class="article global-container article-type-post" itemscope itemprop="blogPost">
  
    <header class="article-header">
      
  
    <h1 class="article-title" itemprop="name">
      服务与进程,文件共享
    </h1>
  

    </header>
  
  <div class="article-meta">
    <a href="/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/" class="article-date">
  <time datetime="2020-02-03T08:29:01.317Z" itemprop="datePublished">2020-02-03</time>
</a>
    
    
  </div>
  
    <span id="busuanzi_container_page_pv">
      本文总阅读量<span id="busuanzi_value_page_pv"></span>次
    </span>
  

  <div class="article-inner">
    
    <div class="article-content article-content-cloud" itemprop="articleBody">
      
        <h2 id="服务与进程"><a href="#服务与进程" class="headerlink" title="服务与进程"></a>服务与进程</h2><h3 id="linux系统的运行级别"><a href="#linux系统的运行级别" class="headerlink" title="linux系统的运行级别"></a>linux系统的运行级别</h3><p>运行级别0：关机模式：poweroff.target</p>
<p>运行级别1：单用户模式，仅用于root用户对系统进行维护时。rescue.target</p>
<p>运行级别2：多用户模式（没有NFS）。multi-user.target</p>
<p>运行级别3：完全多用户模式，即多用户文本界面模式，是标准的运行级别。multi-user.target</p>
<p>运行级别4：特定运行级别，基本不用的用户模式。graphical.target</p>
<p>运行级别5：X11，Linux系统的图形界面运行级别。graphical.target</p>
<p>运行级别6：重新启动。reboot.target</p>
<p>target文件保存在：/lib/systemd/system目录中。</p>
<a id="more"></a>

<p>系统运行级别之间的切换</p>
<p>查看系统当前运行级别：runlevel</p>
<p>init命令进行切换</p>
<h3 id="方法一：重新设置连接文件"><a href="#方法一：重新设置连接文件" class="headerlink" title="方法一：重新设置连接文件"></a>方法一：重新设置连接文件</h3><p>rm -rf /etc/systemd/system/default.target</p>
<p>ln -s /lib/systemd/system/runlevlel3.target  /etc/systemd/system/default.tart</p>
<h3 id="方法二：使用systemctl命令"><a href="#方法二：使用systemctl命令" class="headerlink" title="方法二：使用systemctl命令"></a>方法二：使用systemctl命令</h3><p>systemctl set-default runlevel3.target</p>
<p>使用systemctl管理服务</p>
<p>systemctl  选项 服务名</p>
<p>start：启动      stop：停止   restart：重启  status：服务状态</p>
<h3 id="设置服务的自启动状态"><a href="#设置服务的自启动状态" class="headerlink" title="设置服务的自启动状态"></a>设置服务的自启动状态</h3><p>使用ntsysv 命令设置服务的自启动</p>
<p>ntsysv  –runlevel</p>
<p>level:启动级别</p>
<p>使用systemctl命令设置服务的自启动</p>
<p>查看自启动的状态：is-enabled   服务名称</p>
<p>开启服务的自启动：systemctl enable  服务名称</p>
<p>关闭服务的自启动：systemctl  disable 服务名称</p>
<p>查看所有的服务</p>
<p>关闭selinux安全机制</p>
<p>setenforce 0</p>
<p>查看 getenforce  [以P开头：关闭   以E开头：开启]</p>
<p>systemctl  列出所有的系统服务</p>
<p>systemctl  list-unit-files   列出所有启动unit</p>
<p>list-units  -type=service  -all  列出所有service 类型的unit</p>
<p>list-units  -type=service  -all  grep  cpu   列出cpu电源管理机制的服务</p>
<p>systemctl poweroff   系统关机</p>
<p>reboot    重新启动</p>
<p>suspend     进行睡眠模式</p>
<p>hibernate    进入休眠模式</p>
<p>rescue    强制进入救援模式</p>
<p>energency    强制进入紧急救援模式</p>
<h3 id="进程的延迟与周期调度"><a href="#进程的延迟与周期调度" class="headerlink" title="进程的延迟与周期调度"></a>进程的延迟与周期调度</h3><p>pa 选项</p>
<p>-A :显示系统中所有进程的信息，与-e具有相同的功能。</p>
<p>-a：显示所有用户进程的信息。</p>
<p>-f：完整的显示进程的所有信息</p>
<p>-l :  以长格式显示进程信息</p>
<p>-r:只显示正在运行的进程</p>
<p>-u:显示面向用户的格式</p>
<p>-x:显示所有非控制终端上的进程信息。</p>
<p>-p:显示由进程ID指定的进程的信息</p>
<p>-t:显示指定终端上的进程的信息。</p>
<p>杀死进程</p>
<p>kill  信号代码（9） pid</p>
<p>killall  信号代码  进程名</p>
<p>查看内容使用情况：free</p>
<p>查看CPU使用情况：top  -bn</p>
<p>产看硬盘使用情况：df   -hT</p>
<p>进程的调度</p>
<h4 id="延迟性调试命令：at"><a href="#延迟性调试命令：at" class="headerlink" title="延迟性调试命令：at"></a>延迟性调试命令：at</h4><p>指定时间运行指定的文件</p>
<p>at  -f  文件   -m  时间</p>
<p>按CTRL+D退出</p>
<p>绝对表示法：MM/DD/YYYY   ,today或tomorrow 来表示今天或明天</p>
<p>相对表示法：now+num+时间单位，minutes，hours，days，weeks</p>
<h4 id="周期调度：crontab"><a href="#周期调度：crontab" class="headerlink" title="周期调度：crontab"></a>周期调度：crontab</h4><p>文件存放位置：/var/spool/cron</p>
<p>计划调度服务</p>
<p>crontab -u user {-e | -l | -r}</p>
<p>-u:为指定的用户设置计划任务</p>
<p>-e:编辑计划任务列表</p>
<p>-l：查看指定用户的计划任务列表，默认当前用户</p>
<p>-r：删除用户的计划任务列表</p>
<p>crontab -u user file （file代表任务列表文件）</p>
<p>格式</p>
<p>分钟  小时  日期 月份  星期      任务内容设置</p>
<p>*表示该范围内的任意时间</p>
<p>，表示间隔的多个不连续时间点</p>
<p>-表示一个连续的时间范围</p>
<p>/  指定间隔的时间频率</p>
<h2 id="文件共享"><a href="#文件共享" class="headerlink" title="文件共享"></a>文件共享</h2><p>NFS ：扩展任务（linux系统之间的文件共享）</p>
<p> NFS服务器可以让PC将网络中的NFS服务器共享的目录挂载到本地端的文件系统中，而在本地端的系统中来看，那个远程主机的目录就好像是自己的一个磁盘分区一样，在使用上相当便利； </p>
<p>yum   install -y  nfs-utils</p>
<p>yum   install -y  rpcbind</p>
<p>systemctl  start  rpcbind      启动rpc服务</p>
<p>systemctl start  nfs-server   nfs-secure-server</p>
<p>启动nfs服务和nfs安全传输服务</p>
<p>systemctl enable  nfs-server  nfs-secure-server</p>
<p>自启动</p>
<p>firewall-cmd –permanent –add-service=nfs success</p>
<p>配置防火墙方向nfs服务</p>
<p>firewall-cmd –reload success</p>
<p>首先创建共享目录   ，然后在/etc/exports配置文件中编辑配置即可</p>
<p>mkdir   /public</p>
<p>创建public共享目录</p>
<p>vim  /etc/exports</p>
<p> /public 192.168.245.0/24(ro) /protected </p>
<p> /public 192.168.245.0/24(ro) (只读)</p>
<p> /protected 192.168.245.0/24（rw） （读写）</p>
<p> systemctl reload nfs  </p>
<p> 重新加载NFS服务，使配置文件生效 </p>
<p><strong>修改防火墙设置</strong> </p>
<p>#firewall-cmd –permanent –add-service=samba </p>
<p>//设置防火墙 </p>
<p>#firewall-cmd –reload        //重新加载防火墙</p>
<p>安装 samba 并启动 samba 服务</p>
<p># yum install -y samba samba-client </p>
<p>#systemctl start smb.service nmb.service</p>
<p><strong>建立共享目录</strong> </p>
<p>mkdir /home/company</p>
<p><strong>创建访问账号</strong> </p>
<p>useradd -s /sbin/nologin xzusr </p>
<p>useradd -s /sbin/nologin gcusr </p>
<p>useradd -s /sbin/nologin xsusr </p>
<p>#smbpasswd -a xzusr </p>
<p>#smbpasswd -a gcusr </p>
<p>#smbpasswd -a xsusr</p>
<p>-a 添加 smb 帐号；-x 删除 smb 帐号；-d 禁用 smb 帐号；-e 启用 smb 帐号</p>
<p><strong>修改配置文件：/etc/samba/smb.conf</strong> </p>
<p>默认情况下，Samba 已经配置为允许用户通过远程共享访问账号的主目录。 </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[company]  &#x2F;&#x2F;共享名称为 company </span><br><span class="line">comment &#x3D; company share &#x2F;&#x2F;共享注释 </span><br><span class="line">path &#x3D; &#x2F;home&#x2F;company  &#x2F;&#x2F;指定共享路径 </span><br><span class="line">browseable &#x3D; yes  &#x2F;&#x2F;所有人可见 </span><br><span class="line">guest ok &#x3D; no  &#x2F;&#x2F;拒绝匿名访问 </span><br><span class="line">writeable &#x3D; yes  &#x2F;&#x2F;支持写入数据 </span><br><span class="line">[company] </span><br><span class="line">comment &#x3D; company share </span><br><span class="line">path &#x3D; &#x2F;home&#x2F;company </span><br><span class="line">guest ok &#x3D; no  &#x2F;&#x2F;拒绝匿名访问 </span><br><span class="line">valid users&#x3D;xzusr,gcusr,xsusr &#x2F;&#x2F;允许访问的用户列表 </span><br><span class="line">write list&#x3D;xzusr &#x2F;&#x2F;允许写入的用户列表</span><br><span class="line">valid users-@tech</span><br><span class="line">write list&#x3D;@tech   @代表用户组</span><br><span class="line">systemctl restart smb nmb使更改生效</span><br><span class="line">在 linux 客户端访问测试：smbclient -U smbuser &#x2F;&#x2F;192.168.75.128&#x2F;company </span><br><span class="line">查看服务器的共享文件有哪些：smbclient -L 192.168.75.128 </span><br><span class="line">查看 smbuser 用户可以访问的共享文件：smbclient -L 192.168.75.128 -U smbuser</span><br></pre></td></tr></table></figure></div>

<p><strong>在 Linux 下访问 Windows 共享目录的配置方法</strong> </p>
<div class="highlight-box"autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" contenteditable="true"data-rel="PLAIN"><figure class="iseeu highlight /plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">（1）在 Windows xp 上设置一个共享目录：d:\myfiles </span><br><span class="line">（2）在 Linux 下安装 samba-client 客户端 </span><br><span class="line">\# yum install samba-client </span><br><span class="line">（3）安装 cifs-utils 软件包 </span><br><span class="line">\# yum install cifs-utils </span><br><span class="line">（4）在 Linux 下创建一个挂载点 </span><br><span class="line">\# mkdir &#x2F;mnt&#x2F;Windows </span><br><span class="line">（5）挂载 Windows 上的共享目录 d:\myfiles 到 Linux 下的&#x2F;mnt&#x2F;Windows 目录下 </span><br><span class="line">\# mount -t cifs -o username&#x3D;Administrator &#x2F;&#x2F;192.168.0.3&#x2F;mytest &#x2F;mnt&#x2F;Windows </span><br><span class="line">Enter password: ******** </span><br><span class="line">在&#x2F;etc&#x2F;fstab 文件中，加入该共享目录的挂载信息 </span><br><span class="line">&#x2F;&#x2F;192.168.1.123&#x2F;redhat_disk &#x2F;mnt&#x2F;Windows cifs username&#x3D;tommy,password&#x3D;111111 0 0</span><br></pre></td></tr></table></figure></div>



      
    </div>
    
      <footer class="article-footer">
        完
      </footer>
    
  </div>
  
    
<nav id="article-nav">
  <div class="article-nav-block">
    
      <a href="/2020/02/03/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%8F%8A%E6%8E%A7%E5%88%B6/" id="article-nav-newer" class="article-nav-link-wrap">
        <strong class="article-nav-caption"></strong>
        <div class="article-nav-title">
          
            远程访问及控制
          
        </div>
      </a>
    
  </div>
  <div class="article-nav-block">
    
      <a href="/2020/02/03/DHCP%E9%85%8D%E7%BD%AE/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">DHCP配置</div>
        <strong class="article-nav-caption"></strong>
      </a>
    
  </div>
</nav>

    <link rel="stylesheet" href="/css/gitment.css"> 
<script src="/js/gitment.js"></script>

<div id="gitmentContainer"></div>

<script>
var gitment = new Gitment({
  owner: '',
  repo: '',
  oauth: {
    client_id: '',
    client_secret: '',
  },
})
gitment.render('gitmentContainer')
</script>

  
  
</article>
</section>
        <aside id="sidebar">
  
    <div class="widget-box">
  <div class="avatar-box">
    <img class="avatar" src="/images/default-avatar.jpg" title="图片来自网络"></img>
    <h3 class="avatar-name">
      
        和天意乎
      
    </h3>
    <p class="avatar-slogan">
      视之不见名曰夷，听之不闻名曰希，搏之不得名曰微。此三者不可致诘，故混而为一。
    </p>
  </div>
</div>


  
    

  
    

  
    
  
    
  <div class="widget-box">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">February 2020</a></li></ul>
    </div>
  </div>

  
    
  <div class="widget-box">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2020/02/03/nginx%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">nginx安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/apache%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">apache安全加固</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE%E5%8F%8A%E6%8E%A7%E5%88%B6/">远程访问及控制</a>
          </li>
        
          <li>
            <a href="/2020/02/03/%E6%9C%8D%E5%8A%A1%E4%B8%8E%E8%BF%9B%E7%A8%8B,%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB/">服务与进程,文件共享</a>
          </li>
        
          <li>
            <a href="/2020/02/03/DHCP%E9%85%8D%E7%BD%AE/">DHCP配置</a>
          </li>
        
      </ul>
    </div>
  </div>

  
      <div class="widget-box">
    <h3 class="widget-title">友链</h3>
    <div class="widget">
      
    </div>
  </div>

  
</aside>
      </div>
      <footer id="footer">
  <div class="foot-box global-width">
    &copy; 2020 John Doe &nbsp;&nbsp;
    Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    &nbsp;|&nbsp;主题 <a href="https://github.com/yiluyanxia/hexo-theme-antiquity" target="_blank" rel="noopener">antiquity</a>
    <br>
    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span id="busuanzi_container_site_pv">不蒜子告之   阁下是第<span id="busuanzi_value_site_pv"></span>个访客</span>
  </div>
</footer>
      <script src="https://code.jquery.com/jquery-2.0.3.min.js"></script>
<script>
if (!window.jQuery) {
var script = document.createElement('script');
script.src = "/js/jquery-2.0.3.min.js";
document.body.write(script);
}
</script>

  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




    </div>
    <nav id="mobile-nav" class="mobile-nav-box">
  <div class="mobile-nav-img mobile-nav-top"></div>
  
    <a href="/" class="mobile-nav-link">首页</a>
  
    <a href="/archives" class="mobile-nav-link">归档</a>
  
  <div class="mobile-nav-img  mobile-nav-bottom"></div>
</nav>    
  </div>
</body>
</html>